<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Test</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

</head>
<body>
<h1>获取设备信息</h1>
<p class="dpr"></p>
<p class="physical-width"></p>
<p class="logical-width"></p>
<p class="user-agent"></p>
<p class="ip"></p>
<p class="isp"></p>
<p class="location"></p>


<script>

    let dpr = document.getElementsByClassName('dpr')[0];
    dpr.innerHTML = 'your dpr is ' + window.devicePixelRatio;

    let pw = document.getElementsByClassName('physical-width')[0];
    pw.innerHTML = 'your physical-width is ' + window.screen.width * window.devicePixelRatio;

    let lw = document.getElementsByClassName('logical-width')[0];
    lw.innerHTML = 'your logical-width is ' + document.documentElement.clientWidth;

    let device = document.getElementsByClassName('user-agent')[0];
    device.innerHTML = 'your user-agent  is ' + navigator.userAgent;


    //通过第三方api获取ip/地址/运营商信息
    ajax('https://apimk.com/ip.json', 'GET', null, (responseText) => {
        let data = JSON.parse(responseText);

        let ip = document.getElementsByClassName('ip')[0];
        ip.innerHTML = 'your ip  is ' + data.ip;

        let isp = document.getElementsByClassName('isp')[0];
        isp.innerHTML = 'your isp  is ' + data.isp;

        let location = document.getElementsByClassName('location')[0];
        location.innerHTML = 'your location  is ' + data.city + ',' + data.state + ',' + data.country;
    })


    /**
     * 封装的ajax
     * @param  {String}    url       请求地址
     * @param  {String}    method    请求方法
     * @param  {String}    param     请求参数(没有请传null)
     * @param  {Function}  callback  请求成功后执行的回调函数
     * @return {Object}  无
     */
    function ajax(url, method, param, callback) {

        var xhr = new XMLHttpRequest();

        xhr.onreadystatechange = () => {
            if (xhr.readyState == 4) {
                if ((xhr.status >= 200 && xhr.status < 300) || xhr.status == 304) {
                    callback && callback(xhr.responseText);
                }
            }
        }

        xhr.onerror = (e) => {
            console.log(e.message);
        };

        xhr.open(method, url, true);

        xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');

        xhr.send(param);
    }
</script>

</body>
</html>